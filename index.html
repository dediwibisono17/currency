<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
	<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="css/style.css">
</head>
<body>
	<!-- tabel currency -->
	<div class="container shadow">
		<h1 class="text-center title">Currency Testing</h1>
			<div class="row">
				<div class="col-12 col-md-3 offset-lg-2">
					<label for="">Please input number: </label>
					<input type="number" id="my-numb" value="1" class="form-control input">
				</div>
			</div>

			<br>
			
			<div class="row cont">
				<div class="col-12 col-md-3 offset-lg-2">
					<h1>From</h1>
					<select class="custom-select" name="from" id="from">
						<option value="EUR">EUR</option>
					</select>
				</div>
					
				<div class="col-12 col-md-1">
					<img src="img/orientation.png" class="orient" alt="orientation" onclick="swap()" width="32" height="32">
				</div>
			
				<div class="col-12 col-md-3">
					<h1>To</h1>
					<select class="custom-select" name="to" id="to">
						<option value="IDR">IDR</option>
						<option value="EUR">EUR</option>
					</select>
				</div>
				<div class="col-12 col-md-2">
					<input type="button" class="btn btn-dark" id="button1" value="Submit" onclick="compare()" />
				</div>
				<div class="col-12 col-md-3 offset-lg-2">
					<button type="button" class="btn btn-link btn-sm" style="margin:16px 0" data-toggle="modal" data-target="#exampleModalCenter">
						List Currency
					</button>
				</div>
				<div class="col-12 col-md-4 offset-lg-4 result">
					<div class="res">
						The result is 
						<span id="result"></span>
					</div>
					<div class="time">updated at <span id="time"></span></div>
				</div>
			</div>
			<br>
			<div class="text-center">&copy; Dedi 2020</div>
			
			<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
				<div class="modal-dialog modal-dialog-centered" role="document">
				<div class="modal-content">
					<div class="modal-header">
					<h5 class="modal-title" id="exampleModalLongTitle">List Currency</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					</div>
					<div class="modal-body">
						<div class="table-hide">
							<input id="myInput" class="form-control col-12 col-md-6" type="text" placeholder="Search..">
							<br>
							<table class="table table-striped">
								<thead>
								<tr>
									<th>Code Currency</th>
									<th>Detail Currency</th>
								</tr>
								</thead>
								<tbody id="myTable">
								<tr>
					
								</tr>
								</tbody>
							</table>
						</div>
					</div>
					<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
					</div>
				</div>
				</div>
			</div>
		</div>
	</div>
    
	<script type="text/javascript" src="js/jquery-1.12.4.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <script>

		$("#myInput").on("keyup", function() {
			var value = $(this).val().toLowerCase();
			$("#myTable tr").filter(function() {
			$(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
			});
		});

		$("#my-numb").on("keyup", function() {
			$(this).toLocaleString('id')
		});

		$()

		var objectCurrency = [
			{
				name : 'IDR',
				detail : 'Indonesia Rupiah'
			},
			{
				name : 'USD',
				detail : 'US Dollar'
			},
			{
				name : 'AUD',
				detail : 'Australian Dollar'
			},
			{
				name : 'BGN',
				detail : 'Bulgarian Lev'
			},
			{
				name : 'BRL',
				detail : 'Brazilian Real'
			},
			{
				name : 'CAD',
				detail : 'Canadian Dollar'
			},
			{
				name : 'CHF',
				detail : 'Swiss Franc'
			},
			{
				name : 'CNY',
				detail : 'Yuan Renminbi'
			},
			{
				name : 'CZK',
				detail : 'Czech Koruna'
			},
			{
				name : 'DKK',
				detail : 'Danish Krone'
			},
			{
				name : 'GBP',
				detail : 'Pound Sterling'
			},
			{
				name : 'HKD',
				detail : 'Hong Kong Dollar'
			},
			{
				name : 'HRK',
				detail : 'Kuna'
			},
			{
				name : 'HUF',
				detail : 'Forint'
			},
			{
				name : 'ILS',
				detail : 'New Israeli Sheqel'
			},
			{
				name : 'INR',
				detail : 'Indian Rupee'
			},
			{
				name : 'ISK',
				detail : 'Iceland Krona'
			},
			{
				name : 'JPY',
				detail : 'Yen'
			},
			{
				name : 'KRW',
				detail : 'Won'
			},
			{
				name : 'MXN',
				detail : 'Mexican Peso'
			},
			{
				name : 'MYR',
				detail : 'Malaysian Ringgit'
			},
			{
				name : 'NOK',
				detail : 'Norwegian Krone'
			},
			{
				name : 'NZD',
				detail : 'New Zealand Dollar'
			},
			{
				name : 'PHP',
				detail : 'Phillipine Peso'
			},
			{
				name : 'PLN',
				detail : 'Zloty'
			},
			{
				name : 'RON',
				detail : 'Romanian Leu'
			},
			{
				name : 'RUB',
				detail : 'Russian Rubble'
			},
			{
				name : 'SEK',
				detail : 'Swedish Krona'
			},
			{
				name : 'SGD',
				detail : 'Singapore Dollar'
			},
			{
				name : 'THB',
				detail : 'Baht'
			},
			{
				name : 'TRY',
				detail : 'Turkish Lira'
			},
			{
				name : 'ZAR',
				detail : 'Rand'
			},
		]
		
		objectCurrency.forEach ( result => {
			$("#myTable").append(`
				<tr>
					<td>${result.name}</td>
					<td>${result.detail}</td>
				</tr>
			`)
		})

        function swap() {
            let a = $("#from").val();
            let b = $("#to").val();
            [a, b] = [b, a];
            $("#from").val(a);
            $("#to").val(b)
        }

        $("#from")

        let url = 'https://api.exchangeratesapi.io/latest'
		$.ajax({
			url: url,
			type: 'GET',
			success: (response => {
				let from = $("#from");
				let to = $("#to");
				// buat munculin key
				$.each(response.rates, function(key, value){
					from.append(`
						<option value=${key}>${key}</option>
					`);
					to.append(`
						<option value=${key}>${key}</option>
					`)				
				});
			})
		})

		function compare(){
			let from = $("#from").val();
			let to = $("#to").val();
			$.ajax({
				url: url,
				type: 'GET',
				data: { base: from, symbols: to },
				success: (response => {
					let number = $("#my-numb").val();
					let parsNumber = parseInt(number);
					let timenya = $("#time");
					let today = response.date;
					var monthWording = {
							'01':'Januari',
							'02':'Februari',
							'03':'Maret',
							'04':'April',
							'05':'Mei',
							'06':'Juni',
							'07':'Juli',
							'08':'Agustus',
							'09':'September',
							'10':'Oktober',
							'11':'November',
							'12':'Desember',
						}

					let sliceMonth = today.slice(5,7);
					let sliceDay = today.slice(8,10)
					let sliceYear = today.slice(0,4)
					
					let resultToday = `${sliceDay} ${monthWording[sliceMonth]} ${sliceYear}`
					
					timenya.text(resultToday);

					$.each(response.rates, function(key, value){
						var currency = parsNumber * value;
                        var theCurrency = currency.toLocaleString('id');
                        var result = $("#result");
						console.log("hasilnya: ", currency);
                        result.text(`${theCurrency} - ${key}`)
					});
				})
			})
		}
    </script>
</body>
</html>